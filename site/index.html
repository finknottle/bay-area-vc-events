<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bay Area VC Events</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; }
      .muted { color: #666; }
      .event { padding: 0.75rem 0; border-bottom: 1px solid #eee; }
      a { color: #0b5fff; text-decoration: none; }
      a:hover { text-decoration: underline; }
      input { padding: 0.5rem; width: min(520px, 100%); }
    </style>
  </head>
  <body>
    <h1>Bay Area VC Events</h1>
    <p class="muted">Auto-collected from VC/community sites. MVP quality (will improve source-specific parsing).</p>

    <input id="q" placeholder="Filter by keyword (e.g., AI, demo day, Palo Alto)…" />

    <div id="list"></div>

    <script>
      async function load() {
        const res = await fetch('./events.json', { cache: 'no-store' });
        const data = await res.json();
        return data.events || [];
      }

      function render(events, q) {
        const list = document.getElementById('list');
        list.innerHTML = '';
        const query = (q || '').toLowerCase().trim();
        const filtered = events.filter(e => !query || (e.title || '').toLowerCase().includes(query));

        if (!filtered.length) {
          list.innerHTML = '<p class="muted">No events match.</p>';
          return;
        }

        for (const e of filtered.slice(0, 200)) {
          const div = document.createElement('div');
          div.className = 'event';

          const start = e.start ? new Date(e.start) : null;
          const when = start ? start.toLocaleString('en-US', { dateStyle: 'medium', timeStyle: 'short' }) : '—';

          const src = document.createElement('div');
          src.className = 'muted';
          src.textContent = `${when} • ${e.source_name}`;

          const title = document.createElement('div');
          if (e.rsvp_url) {
            const a = document.createElement('a');
            a.href = e.rsvp_url;
            a.target = '_blank';
            a.rel = 'noreferrer';
            a.textContent = e.title || '(untitled)';
            title.appendChild(a);
          } else {
            title.textContent = e.title || '(untitled)';
          }

          const meta = document.createElement('div');
          meta.className = 'muted';
          meta.textContent = e.location ? e.location : e.source_url;

          div.appendChild(src);
          div.appendChild(title);
          div.appendChild(meta);
          list.appendChild(div);
        }
      }

      (async function() {
        const events = await load();
        const q = document.getElementById('q');
        render(events, '');
        q.addEventListener('input', () => render(events, q.value));
      })();
    </script>
  </body>
</html>
